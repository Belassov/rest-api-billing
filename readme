üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∫ —ç—Ç–æ–º—É –º–æ–º–µ–Ω—Ç—É

–ö –≠—Ç–∞–ø—É 4 —É —Ç–µ–±—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

billing/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ server/
‚îÇ       ‚îî‚îÄ‚îÄ main.go
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ api/          ‚Üê –∑–¥–µ—Å—å –±—É–¥—É—Ç HTTP-—Ö–µ–Ω–¥–ª–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ model/        ‚Üê –∑–¥–µ—Å—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö (Order –∏ —Ç.–ø.)
‚îÇ   ‚îî‚îÄ‚îÄ repo/         ‚Üê (–ø–æ–∫–∞ –Ω–µ –Ω—É–∂–µ–Ω, –ø–æ—è–≤–∏—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –ë–î)
‚îú‚îÄ‚îÄ go.mod
‚îî‚îÄ‚îÄ go.sum

üî∏ –ì–¥–µ –¥–µ–ª–∞—Ç—å CRUD (in-memory)

üëâ CRUD-–ª–æ–≥–∏–∫–∞ –∂–∏–≤—ë—Ç –≤ internal/api/.
–¢–∞–º –±—É–¥—É—Ç —Ñ–∞–π–ª—ã —Å —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç HTTP-–∑–∞–ø—Ä–æ—Å—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç JSON.

–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ internal/api/:
internal/api/
‚îú‚îÄ‚îÄ router.go     ‚Üê –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ—É—Ç–µ—Ä–∞ (chi)
‚îî‚îÄ‚îÄ order.go      ‚Üê —Ö–µ–Ω–¥–ª–µ—Ä—ã –¥–ª—è –∑–∞–∫–∞–∑–æ–≤

–ß—Ç–æ –≤ –∫–∞–∂–¥–æ–º —Ñ–∞–π–ª–µ
internal/model/order.go

–¢—É—Ç —Ö—Ä–∞–Ω–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–∞–∫–∞–∑–∞ (–¥–∞–Ω–Ω—ã–µ):

package model

type Order struct {
    ID     int     `json:"id"`
    UserID int     `json:"user_id"`
    Amount float64 `json:"amount"`
    Status string  `json:"status"`
}

internal/api/order.go

–¢—É—Ç –ª–æ–≥–∏–∫–∞ CRUD (—Ä–∞–±–æ—Ç–∞ —Å –∑–∞–∫–∞–∑–∞–º–∏ –≤ –ø–∞–º—è—Ç–∏):

—Å–æ–∑–¥–∞—ë–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é orders map[int]model.Order

–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏–∏-—Ö–µ–Ω–¥–ª–µ—Ä—ã:
CreateOrder, GetOrder, ListOrders, DeleteOrder

internal/api/router.go

–¢—É—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—à—å —Ä–æ—É—Ç–µ—Ä (chi) –∏ —Å–≤—è–∑—ã–≤–∞–µ—à—å –ø—É—Ç–∏:

r.Route("/orders", func(r chi.Router) {
    r.Get("/", ListOrders)
    r.Post("/", CreateOrder)
    r.Get("/{id}", GetOrder)
    r.Delete("/{id}", DeleteOrder)
})

cmd/server/main.go

–ó–¥–µ—Å—å —Ç–æ–ª—å–∫–æ –∑–∞–ø—É—Å–∫:

package main

import (
    "billing/internal/api"
    "net/http"
)

func main() {
    r := api.NewRouter()
    http.ListenAndServe(":8080", r)
}


üí¨ –¢–≤–æ—è –∑–∞–¥–∞—á–∞ —Å–µ–π—á–∞—Å:

–°–æ–∑–¥–∞—Ç—å internal/model/order.go

–°–æ–∑–¥–∞—Ç—å internal/api/order.go

–°–æ–∑–¥–∞—Ç—å internal/api/router.go

–í main.go –ø–æ–¥–∫–ª—é—á–∏—Ç—å api.NewRouter()

–•–æ—á–µ—à—å, —è –ø–æ–∫–∞–∂—É –ø–æ—à–∞–≥–æ–≤–æ, –∫–∞–∫ –∑–∞–ø–æ–ª–Ω–∏—Ç—å order.go –∏ router.go, —á—Ç–æ–±—ã CRUD-—Å–µ—Ä–≤–µ—Ä –∑–∞—Ä–∞–±–æ—Ç–∞–ª (—Å —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∑–∞–∫–∞–∑–æ–≤ –≤ –ø–∞–º—è—Ç–∏)?